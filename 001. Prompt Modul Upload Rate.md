Konteks teknis (WAJIB IKUTI):

1. Stack aplikasi:

   - Backend: Laravel (PHP 8+).
   - Admin panel: FilamentPHP versi 4 (VERSI TERBARU).
   - Database: SQL Server.
   - Database name: acurex_sql_db.
   - Semua tabel modul rate disimpan di schema: reference.

2. Syarat khusus Filament:

   - WAJIB gunakan sintaks & cara kerja Filament v4, JANGAN pakai style v3/v2/v1.
   - Resource ditempatkan di panel "Admin" dengan namespace:
     App\Filament\Admin\Resources\...
   - Gunakan pola:
     - Resource: XxxResource extends Filament\Resources\Resource
     - form(Schema $schema): Schema
     - table(Table $table): Table
     - infolist(Infolist $infolist): Infolist
     - Pages: List, Create, View, Edit (di folder Resource\Pages).

3. DB & SQL Server:

   - Jangan buat migration Laravel.
   - Saya butuh script SQL Server yang bisa langsung dijalankan di SSMS:
     - `CREATE TABLE` lengkap dengan PK, FK, index yang perlu.
     - `INSERT` seed awal (boleh contoh beberapa baris, tidak harus full).
   - Tabel WAJIB di schema `reference`, bukan `dbo`.
   - Setiap tabel WAJIB punya kolom standar:
     created_at datetime NOT NULL,
     updated_at datetime NULL,
     deleted_at datetime NULL,
     created_by bigint NOT NULL,
     keterangan varchar(255) NULL

4. Pola umum modul rate:

   - Selalu ada:
     a) Tabel master: info umum produk rate (misal kode, nama, persen, range usia/tenor, dsb).
     b) Tabel detail: nilai rate per kombinasi parameter (misal usia x jangka waktu, atau kombinasi lain sesuai file Excel).
   - Nama schema fix: reference.
   - Nama tabel master & detail akan saya kasih nanti di spesifikasi modul.
   - Range (misal usia, jangka waktu, tenor, dsb) harus bisa DINAMIS per record master, tidak hardcode 0-80 atau 1-15.

5. Upload & Import Excel:

   - Saya akan memberikan file Excel contoh (template) untuk modul rate ini.
   - Tugas Anda:
     - Baca struktur file tersebut (header, baris data, baris khusus seperti "USIA", "Jangka Waktu", dsb).
     - Jelaskan asumsi formatnya secara eksplisit.
     - Buat class Import Laravel (pakai maatwebsite/excel) yang:
       - Membaca file sesuai format template.
       - Melakukan validasi format (contoh:
         - header baris 1/2 sesuai teks/angka yang diharapkan,
         - kolom angka benar-benar numeric,
         - beri pesan error yang jelas jika salah).
       - Saat import:
         - Hapus seluruh data detail lama untuk master tersebut (replace total).
         - Insert data baru ke tabel detail.
         - Update range (misal usia_min/max, tenor_min/max, dsb) di tabel master berdasarkan data yang berhasil di-import.
       - Untuk SQL Server: ingat batas 2100 parameter.
         - Jika melakukan bulk insert array, pecah menjadi batch (misal 150 row per insert) agar tidak kena error parameter > 2100.
       - Tangani kemungkinan nilai 0 / kosong:
         - Kalau bisnis rule-nya: 0 berarti "tidak ada rate", jangan disimpan di tabel detail.

6. Download Excel (Rate):

   - Buat export Excel dengan maatwebsite/excel.
   - Format file hasil download harus mengikuti struktur template (atau bentuk yang saya minta untuk modul tersebut):
     - Header dan urutan kolom SERUPA dengan template upload.
     - Data diisi dari tabel detail (bukan hardcode).
   - Buat controller + route untuk download:
     - Route GET, nama route jelas (misal: reference.<nama_modul>.download-rate-excel).
   - Di Filament Resource, tambahkan action di row:
     - "Download Rate (Excel)" yang memanggil route tersebut.

7. Download PDF:

   - Pakai barryvdh/laravel-dompdf.
   - Tampilkan tabel rate lengkap sesuai kombinasi detail dari DB.
   - Usahakan 1 halaman (boleh pakai custom paper size & CSS `page-break-inside: avoid`).
   - Buat controller + Blade view.
   - Tambahkan row action di Filament: "Download PDF".

8. Filament Resource (Panel Admin → Folder Reference):

   - Buat Resource baru di `App\Filament\Admin\Resources\Reference\<NamaModul>Resource`.
   - Di List/Table:
     - Tampilkan kolom penting dari master (kode, nama, persen, range, dsb).
     - Tambahkan record actions:
       - Show
       - Edit
       - Download Rate (Excel)
       - Download PDF
   - Di header List:
     - Tambahkan tombol "Create" (default).
     - Jika perlu template Excel kosong, tambahkan action Download Template (Excel).
   - Di halaman Edit:
     - Header actions:
       - Kembali ke Tabel (back to index),
       - Import Rate (Excel) dengan FileUpload (pakai disk "private" atau "local" – sebutkan),
       - Delete.
   - Di halaman View:
     - Header action: Kembali ke Tabel.
     - Infolist:
       - Section 1: data master (field-field utama).
       - Section 2: data detail (misalnya tabel kecil repeatable yang menampilkan kombinasi parameter dan rate, atau kalau kepanjangan, minimal ringkasan yang berguna).

9. Model Eloquent:

   - Buat model untuk tabel master & detail dengan:
     - namespace App\Models\Reference;
     - protected $table = 'reference.<nama_tabel>';
     - relasi:
       - master -> details: hasMany(..., 'foreign_key_detail').
       - detail -> master: belongsTo(..., 'foreign_key_detail').
   - Tambahkan SoftDeletes di kedua model (deleted_at sudah ada).
   - Isi $fillable dan $casts yang masuk akal (misal rate float, usia integer, dll).

10. Penulisan jawaban:
    - Jawaban harus sangat terstruktur dan bisa langsung saya copy-paste:
      - Bagian A: Script SQL (CREATE TABLE + seed contoh).
      - Bagian B: Model Laravel.
      - Bagian C: Import Excel (class + cara pakai di action Filament).
      - Bagian D: Export Excel (class + controller + route).
      - Bagian E: Download PDF (controller + view).
      - Bagian F: Filament Resource (Resource + Schemas form/table/infolist + Pages).
    - Jelaskan bagian yang perlu saya sesuaikan manual (misal nama modul, nama file, atau path).
    - Jangan membuat migration.
    - Jangan gunakan fitur/namespace lama Filament v3 ke bawah.

=============================================================
Spesifikasi modul rate yang akan saya buat sekarang:

1. Nama modul rate: <ISI DI SINI, misal: "Base Rate Nasre Ujroh 12.5%">
2. Nama tabel master: reference.<ISI_NAMA_TABEL_MASTER>
3. Nama tabel detail: reference.<ISI_NAMA_TABEL_DETAIL>
4. Kolom tambahan di tabel master selain standar:
   - Jelaskan: contoh [kode, nama, persen_ujroh, usia_min/max, tenor_min/max, dsb].
5. Struktur kombinasi rate di tabel detail:
   - Sebutkan field apa saja: contoh [usia, jangka_waktu, rate], atau [umur, tenor, plan, rate], dsb.
6. Format file Excel upload:
   - Saya lampirkan file Excel contoh di chat ini.
   - Jelaskan pola header dan barisnya jika sudah Anda analisa (supaya dokumentasinya jelas).
7. Behaviour khusus (kalau ada):
   - Misal: 0 dianggap tidak ada rate, atau perlu pembulatan sampai 2 desimal, atau butuh validasi range tertentu, dll.

Silakan baca semua konteks di atas dan

- desain struktur tabel master & detail,
- lalu buat semua kode dan konfigurasi yang dibutuhkan (SQL, Model, Resource, Import/Export, PDF) untuk modul ini.
  Jika ada asumsi yang dibuat, tuliskan di jawaban.
